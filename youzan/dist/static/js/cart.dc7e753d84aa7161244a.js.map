{"version":3,"sources":["webpack:///./src/modules/js/avInit.js","webpack:///./src/modules/js/api.js","webpack:///./src/modules/js/mixin.js","webpack:///./src/pages/cart/cart.js"],"names":["av_min_default","a","init","appId","appKey","__webpack_exports__","objName","Query","find","then","data","map","item","extends_default","attributes","toast_default","message","position","duration","mixin","filters","floatnum","value","strValue","String","indexOf","split","length","__WEBPACK_IMPORTED_MODULE_3_vue__","el","cartList","total","selectsList","status","editIndex","removeList","removeNum","numReg","isMessageDialogShow","delInfo","isEmpty","components","computed","allPick","get","this","every","checked","set","forEach","shop","goodList","good","i","allremovePick","removeChecked","delInfoMessage","len","watch","valueTotal","removeTotal","payArr","removeArr","flag","price","number","push","methods","getCartList","_this","Object","__WEBPACK_IMPORTED_MODULE_4_js_api_js__","res","originList","JSON","parse","editing","statusMessage","touchLeftStart","startX","endX","isShow","offset","selectGood","shopIndex","goodIndex","name","selectShop","toggleItemStatus","toggleAllPick","addNum","test","minusNum","showDelDialog","delSingleItem","confirmDel","_this2","shopIndexObj","undefined","newChildArr","wanToDelArr","j","includes","created","updated","$nextTick","_this3","allLis","document","querySelectorAll","_loop","hammer","__WEBPACK_IMPORTED_MODULE_6_hammerjs___default","dataset","shopItem","goodItem","on","e","center","x","isFinal","mixins","__WEBPACK_IMPORTED_MODULE_5_js_mixin_js__"],"mappings":"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","file":"static/js/cart.dc7e753d84aa7161244a.js","sourcesContent":["import AV from \"leancloud-storage\"\n\nlet APP_ID = 'IOdBWAtbQXIu491P7ldb0gB6-gzGzoHsz';\nlet APP_KEY = 'qlHMaucWHOv4mW5yejNzJf6V';\n\nAV.init({\n    appId: APP_ID,\n    appKey: APP_KEY\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/avInit.js","import AV from \"leancloud-storage\"\nimport \"js/avInit.js\"\n\nimport { Toast } from 'mint-ui';\n\nexport default function(objName){\n    var query = new AV.Query(objName)\n    return query.find().then(data => {\n        return data.map(item => {return {...item.attributes}})\n    },() => {\n        Toast({\n            message: '网络异常',\n            position: 'bottom',\n            duration: 2500\n        })\n    })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/api.js","let mixin = {\n    filters: {\n        floatnum(value) {\n            let strValue = String(value)\n            if (strValue.indexOf(\".\") === -1) {\n                return strValue + \".00\"\n            }\n            else if (strValue.split(\".\")[1].length === 1) {\n                return strValue + \"0\"\n            }\n            else {\n                return strValue\n            }\n        }\n    }\n}\n\nexport default mixin\n\n\n// WEBPACK FOOTER //\n// ./src/modules/js/mixin.js","import \"./cart_base.css\"\nimport \"./cart_trade.css\"\nimport \"./cart.css\"\n\nimport Vue from \"vue\";\nimport leanCloudTool from \"js/api.js\";\nimport priceMixin from \"js/mixin.js\"\nimport Hammer from \"hammerjs\"\n\nnew Vue({\n    el: \"#app\",\n    data: {\n        cartList: null,\n        total: 0,\n        selectsList: [],\n        status: \"view\",\n        editIndex: 0,\n        removeList: [],\n        removeNum: 0,\n        numReg: /^[1-9]\\d*$/,\n        isMessageDialogShow: false,\n        delInfo: [],\n        isEmpty: false,\n    },\n    components: {},\n    computed: {\n        allPick: {\n            get() {\n                if (this.cartList&&this.cartList.length) {\n                    return this.cartList.every(item => item.checked)\n                }\n            },\n            set(value) {\n                this.cartList.forEach(shop => {\n                    shop.checked = value\n                    shop.goodList.forEach(good => {\n                        good.checked = value\n                    })\n                })\n                for (let i = 0; i < this.cartList.length; i++) {\n                    Vue.set(this.cartList, i, this.cartList[i])\n                }\n            },\n        },\n        allremovePick: {\n            get() {\n                if (this.cartList&&this.cartList.length) {\n                    return this.cartList.every(item => item.removeChecked)\n                }\n            },\n            set(value) {\n                this.cartList.forEach(shop => {\n                    shop.removeChecked = value\n                    shop.goodList.forEach(good => {\n                        good.removeChecked = value\n                    })\n                })\n                for (let i = 0; i < this.cartList.length; i++) {\n                    Vue.set(this.cartList, i, this.cartList[i])\n                }\n            },\n        },\n        delInfoMessage() {\n            let len = this.removeList.length\n            if (len === 1 || len === 0) {\n                return \"确定要删除该件商品吗?\"\n            } else {\n                return `确定要删除这${len}件商品吗?`\n            }\n        }\n    },\n    watch:{\n        cartList: function() {\n            let valueTotal = 0\n            let removeTotal = 0\n            let payArr = []\n            let removeArr = []\n            let flag = true\n            if (this.cartList&&this.cartList.length) {\n                this.cartList.forEach(shop => {\n                    if (shop.goodList.length > 0) {flag = false}\n                    shop.goodList.forEach(good => {\n                        if (good.checked) {\n                            valueTotal += good.price * good.number\n                            payArr.push(good)\n                        }\n                        if (good.removeChecked) {\n                            removeTotal += 1\n                            removeArr.push(good)\n                        }\n                    })\n                })\n            }\n            this.removeNum = removeTotal\n            this.removeList = removeArr\n            this.total = valueTotal\n            this.selectsList = payArr\n            this.isEmpty = flag\n        }\n    },\n    methods: {\n        getCartList() {\n            leanCloudTool(\"Cart\").then(res => {\n                let originList = JSON.parse(res[0].cartList).cartList\n                originList.forEach(shop => {\n                    shop.checked = false\n                    shop.removeChecked = false\n                    shop.editing = false\n                    shop.statusMessage = \"编辑\"\n                    shop.goodList.forEach(good => {\n                        good.checked = false\n                        good.removeChecked = false\n                        good.touchLeftStart = false\n                        good.startX = 0\n                        good.endX = 0\n                        good.isShow = false\n                        good.offset = 0\n                    })\n                })\n                this.cartList = originList\n            })\n        },\n        selectGood(shop, good, shopIndex, goodIndex) {\n            let name = this.status === \"view\" ? 'checked' : 'removeChecked'\n            good[name] = !good[name]\n            Vue.set(this.cartList, shopIndex, this.cartList[shopIndex])\n            shop[name] = shop.goodList.every(good => {\n                return good[name]\n            })\n        },\n        selectShop(shop,shopIndex) {\n            let name = this.status === \"view\" ? 'checked' : 'removeChecked'\n            shop[name] = !shop[name]\n            Vue.set(this.cartList, shopIndex, this.cartList[shopIndex])\n            shop.goodList.forEach(good => {\n                good[name] = shop[name]\n            })\n        },\n        toggleItemStatus(shop, shopIndex) {\n            shop.editing = !shop.editing\n            if (shop.editing) {\n                this.editIndex = shopIndex\n                shop.statusMessage = \"完成\"\n                this.status = \"write\"\n            } else {\n                shop.statusMessage = \"编辑\"\n                this.status = \"view\"\n                shop.goodList.forEach(item => {item.offset = 0})\n                Vue.set(this.cartList, shopIndex,shop)\n            }\n        },\n        toggleAllPick() {\n            let name = this.status === \"view\" ? 'allPick' : 'allremovePick'\n            this[name] = !this[name]\n        },\n        addNum(good, shopIndex) {\n            if (good.number <= 0) {return}\n            if (this.numReg.test(String(good.number))) {\n                good.number += 1\n            } else {\n                good.number = 1\n            }\n            Vue.set(this.cartList, shopIndex, this.cartList[shopIndex])\n        },\n        minusNum(good, shopIndex) {\n            if (good.number && good.number > 1) {\n                good.number -= 1\n            }\n            Vue.set(this.cartList, shopIndex, this.cartList[shopIndex])\n        },\n        showDelDialog() {\n            this.isMessageDialogShow = true\n        },\n        delSingleItem(shop, shopIndex, good, goodIndex) {\n            this.delInfo = []\n            this.delInfo.push({shop, shopIndex, good, goodIndex})\n            this.showDelDialog()\n        },\n        confirmDel() {\n            let shopIndexObj = {}\n            if (this.delInfo.length === 0) {\n                this.cartList.forEach((shop, shopIndex) => {\n                    shop.goodList.forEach((good, goodIndex) => {\n                        if (good.removeChecked) {\n                            this.delInfo.push({shop, shopIndex, good, goodIndex})\n                            if (shopIndexObj[shopIndex] === undefined) {\n                                shopIndexObj[shopIndex] = [goodIndex]\n                            } else {\n                                shopIndexObj[shopIndex].push(goodIndex)\n                            }\n                        }\n                    })\n                })\n            } else {\n                let shopIndex = this.delInfo[0].shopIndex\n                let goodIndex = this.delInfo[0].goodIndex\n                shopIndexObj[shopIndex] = [goodIndex]\n            }\n            for (let i = 0; i < this.delInfo.length; i++) {\n                let item = this.delInfo[i].shop\n                let newChildArr = []\n                let wanToDelArr = shopIndexObj[this.delInfo[i].shopIndex]\n                for (let j = 0; j < item.goodList.length; j++) {\n                    if (wanToDelArr.includes(j)) {\n                        continue\n                    } else {\n                        newChildArr.push(item.goodList[j])\n                    }\n                }\n                item.goodList = newChildArr\n                if (item.goodList.length === 0) {\n                    item.editing = false\n                    item.statusMessage = \"编辑\"\n                }\n                Vue.set(this.cartList, this.delInfo[i].shopIndex, item)\n            }\n            this.isMessageDialogShow = false\n            this.delInfo = []\n            this.status = \"view\"\n        }\n    },\n    created() {\n        this.getCartList()\n    },\n    updated() {\n        this.$nextTick(function() {\n            let allLis = document.querySelectorAll(\"[data-shop]\")\n            for (let i = 0; i < allLis.length; i++) {\n                let item = allLis[i]\n                let hammer = new Hammer(item)\n\n                let shopIndex = item.dataset.shop\n                let goodIndex = item.dataset.good\n                let shopItem = this.cartList[shopIndex]\n                let goodItem = shopItem.goodList[goodIndex]\n\n                hammer.on('panleft', (e) => {\n                    if (!shopItem.editing || goodItem.isShow ) {\n                        return\n                    }\n                    if (!goodItem.touchLeftStart) {\n                        goodItem.touchLeftStart = true\n                        goodItem.startX = e.center.x\n                    }\n                    if (!goodItem.isShow) {\n                        if (e.center.x - goodItem.startX < -40) {\n                            goodItem.isShow = true\n                            goodItem.offset = -60\n                        } else {\n                            goodItem.offset = e.center.x - goodItem.startX\n                        }\n                    }\n                    if (e.isFinal) {\n                        goodItem.endX = e.center.x\n                        goodItem.touchLeftStart = false\n                    }\n                    Vue.set(this.cartList, this.cartList[shopIndex], this.cartList[shopIndex])\n                })\n                hammer.on('panright', (e) => {\n                    if (!shopItem.editing || !goodItem.isShow ) {\n                        return\n                    }\n                    goodItem.offset = 0\n                    goodItem.isShow = false\n                    Vue.set(this.cartList, this.cartList[shopIndex], this.cartList[shopIndex])\n                })\n            }\n        })\n\n    },\n    mixins: [priceMixin],\n})\n\n\n// WEBPACK FOOTER //\n// ./src/pages/cart/cart.js"],"sourceRoot":""}